# Imagineer Project Organization Plan

## Current Issues

1. **Too many files in root** - 13+ files/scripts cluttering root directory
2. **Redundant docs** - Multiple setup/readme files with overlapping info
3. **Mixed concerns** - Setup scripts, server scripts, and app scripts all in root
4. **Local data** - models/ and outputs/ in repo (should be on Speedy drive)
5. **Backup files** - config.yaml.backup files in root

## Proposed Clean Structure

```
imagineer/
├── README.md                          # Main project overview
├── QUICKSTART.md                      # Getting started guide
├── LICENSE
├── .gitignore
├── .editorconfig
├── requirements.txt
├── setup.py
├── config.yaml                        # Main configuration
│
├── docs/                              # All documentation
│   ├── SETUP.md                       # Environment setup
│   ├── API.md                         # API documentation
│   ├── DEPLOYMENT.md                  # Production deployment
│   └── DEVELOPMENT.md                 # Development guide
│
├── scripts/                           # All executable scripts
│   ├── setup/                         # One-time setup scripts
│   │   ├── setup_drives.sh
│   │   ├── setup_samba.sh
│   │   └── setup_env.sh
│   ├── start_server.sh                # Start API server
│   ├── start_dev.sh                   # Start API + frontend dev server
│   └── generate.sh                    # Quick CLI wrapper
│
├── src/imagineer/                     # Core library
│   ├── __init__.py
│   ├── utils.py
│   ├── pipeline.py                    # Generation pipeline
│   └── config.py                      # Config management
│
├── server/                            # Backend API server
│   ├── api.py                         # Flask REST API
│   └── README.md                      # API documentation
│
├── web/                               # Frontend source (React/Vue/etc)
│   ├── package.json                   # Node dependencies
│   ├── vite.config.js                 # Build configuration
│   ├── index.html                     # HTML template
│   ├── src/                           # Frontend source code
│   │   ├── App.jsx
│   │   ├── components/
│   │   │   ├── GenerateForm.jsx
│   │   │   ├── QueueView.jsx
│   │   │   ├── Gallery.jsx
│   │   │   └── Settings.jsx
│   │   ├── api/
│   │   │   └── client.js              # API client
│   │   └── styles/
│   └── README.md                      # Frontend development guide
│
├── public/                            # Built frontend (served by Flask)
│   ├── index.html                     # Built HTML
│   ├── assets/                        # Built JS/CSS
│   └── ... (generated by build)
│
├── examples/                          # Example scripts
│   ├── basic_inference.py
│   ├── generate.py
│   └── train_lora.py
│
├── tests/                             # Test suite (future)
│   └── README.md
│
├── .env.example                       # Environment variables template
├── .claude/                           # Claude Code settings
└── venv/                              # Python virtual environment (git ignored)
```

## Files to Move

### To `docs/`:
- SETUP.md → docs/SETUP.md
- SERVER_README.md → docs/API.md
- SETUP_INSTRUCTIONS.md → docs/DEPLOYMENT.md
- CONTRIBUTING.md → docs/CONTRIBUTING.md

### To `scripts/`:
- start_server.sh → scripts/start_server.sh
- setup_drives.sh → scripts/setup/setup_drives.sh
- setup_samba.sh → scripts/setup/setup_samba.sh
- update_config_for_speedy.sh → scripts/setup/configure_speedy.sh

### To `web/`:
- server/static/index.html → DELETE (will be replaced by React build)
- server/setup_react.sh → DELETE (using Vite instead)

### To Delete:
- config.yaml.backup-* (old backup files)
- models/ symlink (already points to Speedy)
- outputs/ symlink (already points to Speedy)
- data/ symlink (already points to Speedy)
- checkpoints/ symlink (already points to Speedy)

### Keep in Root:
- README.md
- QUICKSTART.md
- LICENSE
- config.yaml
- requirements.txt
- setup.py
- .gitignore
- .editorconfig
- .env.example

## Updated README Structure

**README.md** - Quick overview:
- What is Imagineer
- Key features
- Quick install
- Basic usage
- Link to QUICKSTART.md

**QUICKSTART.md** - Getting started:
- Prerequisites
- Installation steps
- First image generation
- Web UI access
- Common commands

**docs/SETUP.md** - Detailed setup:
- System requirements
- Hardware configuration
- Drive setup
- SMB configuration
- Troubleshooting

**docs/API.md** - Server documentation:
- API endpoints
- Request/response examples
- Web UI features
- Network access

**docs/DEPLOYMENT.md** - Production deployment:
- systemd service
- Reverse proxy
- SSL/HTTPS
- Authentication
- Monitoring

## Frontend Build Setup

### Using Vite + React

**Why Vite?**
- Fast dev server with HMR (Hot Module Replacement)
- Optimized production builds
- Modern, simple configuration
- Built-in TypeScript/JSX support

**Development workflow:**
```bash
# In web/ directory
npm install           # Install dependencies
npm run dev           # Start dev server (port 5173)
npm run build         # Build to public/
npm run preview       # Preview production build
```

**Production workflow:**
```bash
cd web/
npm run build         # Builds to public/
cd ..
python server/api.py  # Serves from public/
```

**Flask Integration:**
```python
# server/api.py serves built frontend
app = Flask(__name__, static_folder='../public', static_url_path='')

@app.route('/')
def index():
    return send_from_directory('../public', 'index.html')
```

## Git Configuration

Update `.gitignore`:
```
# Virtual environment
venv/

# Python
__pycache__/
*.py[cod]
*.so
.Python

# Environment
.env
*.local

# Outputs (stored on Speedy drive)
models/
outputs/
checkpoints/
data/training/*
!data/training/README.md

# Backups
*.backup-*
*.bak

# Logs
*.log

# Frontend
web/node_modules/    # Node dependencies (inside web/)
public/              # Built frontend (generated)
web/dist/            # Alternative build output
.vite/

# IDE
.vscode/
.idea/
*.swp
*.swo

# OS
.DS_Store
Thumbs.db
```

## Implementation Steps

1. **Create directory structure**
   ```bash
   mkdir -p docs scripts/setup tests web/src/{components,api,styles}
   ```

2. **Move documentation files**
   ```bash
   mv SETUP.md docs/
   mv SERVER_README.md docs/API.md
   mv SETUP_INSTRUCTIONS.md docs/DEPLOYMENT.md
   mv CONTRIBUTING.md docs/
   ```

3. **Move script files**
   ```bash
   mv start_server.sh scripts/
   mv setup_drives.sh scripts/setup/
   mv setup_samba.sh scripts/setup/
   mv update_config_for_speedy.sh scripts/setup/configure_speedy.sh
   ```

4. **Clean up**
   ```bash
   rm config.yaml.backup-*
   rm server/setup_react.sh
   ```

5. **Update symlinks** (already done, verify)
   ```bash
   ls -la checkpoints data models outputs
   ```

6. **Update documentation references**
   - Fix all paths in docs
   - Update script references
   - Update QUICKSTART.md paths

7. **Update scripts**
   - Fix paths in start_server.sh
   - Update setup script paths

8. **Create wrapper scripts** (optional)
   ```bash
   # scripts/generate.sh
   #!/bin/bash
   source venv/bin/activate
   python examples/generate.py "$@"
   ```

9. **Setup frontend**
   ```bash
   cd web/
   npm create vite@latest . -- --template react
   npm install axios
   npm install # Install all dependencies
   cd ..
   ```

10. **Update Flask to serve from public/**
    - Modify server/api.py static_folder
    - Test build process

11. **Test everything**
    - Test API server
    - Test frontend dev server
    - Test production build
    - Test generation
    - Verify all documentation links

12. **Commit changes**
    ```bash
    git add .
    git commit -m "Reorganize project structure with proper frontend setup"
    ```

## Benefits

1. **Cleaner root** - Only essential files visible
2. **Organized docs** - All documentation in one place
3. **Clear scripts** - Setup vs runtime scripts separated
4. **Better git** - Proper ignores for generated content
5. **Scalable** - Room for tests, more features
6. **Professional** - Industry-standard layout

## Migration Safety

- Keep backups of moved files
- Test after each major move
- Verify symlinks still work
- Ensure scripts still run
- Check all documentation links

## Future Enhancements

1. Add `tests/` with pytest suite
2. Add `docs/tutorials/` for advanced use cases
3. Add `scripts/backup/` for data management
4. Add CI/CD configuration (.github/workflows/)
5. Add Docker support (Dockerfile, docker-compose.yml)
6. Add web UI build process (if using React)
